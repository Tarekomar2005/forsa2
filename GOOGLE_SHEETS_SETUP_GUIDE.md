# 🚀 دليل إعداد Google Sheets Database - خطوة بخطوة

## 📋 الخطوات بالترتيب (كما طلبت)

### **الخطوة 1: إنشاء Google Sheets جديد**
1. اذهب إلى [Google Sheets](https://sheets.google.com)
2. اضغط على "+" لإنشاء ملف جديد  
3. اسم الملف: "Forsa Orders Database"

### **الخطوة 2: فتح Apps Script**
1. من القائمة: **Extensions > Apps Script**
2. هيطلعلك صفحة الكود

### **الخطوة 3: إضافة الكود**
1. احذف الكود الموجود
2. انسخ الكود من ملف [`google-apps-script-enhanced.js`](file://d:/forsa2/google-apps-script-enhanced.js)
3. الصق الكود في Apps Script

### **الخطوة 4: نشر التطبيق**
1. من فوق دوس: **Deploy > New deployment**
2. اختار **Web app**
3. **Who has access** → خليه **Anyone** (مهم جدًا!) ⚠️
4. دوس **Deploy**
5. **انسخ الـ URL** اللي يطلعلك

### **الخطوة 5: تحديث الموقع**
1. افتح [`test-sheets-setup.html`](file://d:/forsa2/test-sheets-setup.html) في المتصفح
2. حط الرابط اللي نسخته في خانة "رابط Google Sheets"
3. دوس "تحديث الرابط"
4. دوس "اختبار الاتصال"

## ✅ **التأكد من نجاح الإعداد**

### **اختبار الرابط:**
- لو الرابط مضبوط → هتلاقي البيانات ظهرت فورًا في Google Sheets
- هيتكون 3 أوراق جديدة: Contacts, Quick Orders, Complete Orders

### **اختبار من الموقع الرئيسي:**
1. افتح [`index.html`](file://d:/forsa2/index.html)
2. أضف منتجات للسلة
3. أدخل بيانات العميل
4. اضغط "إتمام الطلب"
5. تحقق من Google Sheets → لازم تلاقي البيانات ظهرت

## 🔧 **ملفات المساعدة**

### **1. الكود المحسن:** [`google-apps-script-enhanced.js`](file://d:/forsa2/google-apps-script-enhanced.js)
- يتعامل مع جميع أنواع البيانات
- ينشئ أوراق منفصلة لكل نوع
- يرسل إشعارات بريد إلكتروني (اختياري)

### **2. صفحة الاختبار:** [`test-sheets-setup.html`](file://d:/forsa2/test-sheets-setup.html)
- اختبار الاتصال مع Google Sheets
- مزامنة البيانات المحلية
- عرض الإحصائيات

### **3. لوحة الإدارة:** [`admin-panel.html`](file://d:/forsa2/admin-panel.html)
- عرض جميع البيانات المحفوظة محلياً
- إدارة الطلبات الكاملة مع تفاصيل المنتجات
- إحصائيات شاملة

## 🎯 **بعد الإعداد الناجح**

### **ما يحدث عند إتمام الطلبات:**
1. **الحفظ التلقائي:** البيانات تُحفظ في Google Sheets + التخزين المحلي
2. **الإشعارات:** رسائل تأكيد للعميل والمدير
3. **النسخ الاحتياطية:** نظام مزدوج يضمن عدم فقدان البيانات
4. **التقارير:** إمكانية الوصول للبيانات من أي مكان

### **الوصول للبيانات:**
- **Google Sheets:** للوصول من أي مكان
- **لوحة الإدارة المحلية:** للعمل بدون إنترنت
- **صفحة الاختبار:** للتحقق والمزامنة

## ⚠️ **نصائح مهمة**

1. **احفظ رابط Google Sheets** في مكان آمن
2. **اختبر النظام** قبل تشغيله مع العملاء الحقيقيين
3. **راجع البيانات** في Google Sheets بانتظام
4. **استخدم النسخ الاحتياطية** في لوحة الإدارة

## 🚨 **إذا واجهت مشاكل:**

### **الرابط لا يعمل:**
- تأكد من أن "Who has access" = Anyone
- تأكد من نشر التطبيق كـ Web app
- تأكد من نسخ الرابط الصحيح

### **البيانات لا تظهر:**
- استخدم صفحة الاختبار للتحقق
- راجع Console في المتصفح (F12)
- تأكد من الاتصال بالإنترنت

### **مشاكل في المزامنة:**
- استخدم زر "مزامنة جميع البيانات" في صفحة الاختبار
- تحقق من لوحة الإدارة للبيانات المحلية

---

🎉 **بالتوفيق! الآن لديك نظام قاعدة بيانات احترافي لموقع Forsa**