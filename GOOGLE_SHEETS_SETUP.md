# Google Sheets كـ Database - دليل الإعداد الكامل

## نظرة عامة
تم تطوير نظام متكامل لحفظ جميع طلبات العملاء ورسائل التواصل في Google Sheets تلقائياً. النظام يتضمن:

✅ **حفظ تلقائي** لجميع رسائل التواصل  
✅ **حفظ تلقائي** لجميع الطلبات السريعة  
✅ **نظام احتياطي محلي** في حالة انقطاع الاتصال  
✅ **إشعارات بريد إلكتروني** عند وصول طلبات جديدة  
✅ **مزامنة تلقائية** للبيانات المحفوظة محلياً  

## خطوات الإعداد

### الخطوة 1: إنشاء Google Sheets

1. **إنشاء ملف للرسائل:**
   - اذهب إلى [Google Sheets](https://sheets.google.com)
   - أنشئ ملف جديد وسمه "Forsa Contacts"
   - انسخ ID الملف من الرابط (الجزء بين `/d/` و `/edit`)

2. **إنشاء ملف للطلبات:**
   - أنشئ ملف جديد وسمه "Forsa Orders"
   - انسخ ID هذا الملف أيضاً

### الخطوة 2: إعداد Google Apps Script

1. **إنشاء مشروع جديد:**
   - اذهب إلى [Google Apps Script](https://script.google.com)
   - انقر على "مشروع جديد"
   - سم المشروع "Forsa Database Script"

2. **نسخ الكود:**
   - امسح الكود الافتراضي
   - انسخ محتوى ملف `google-apps-script.js` والصقه

3. **تحديث المعلومات:**
   ```javascript
   // استبدل هذه القيم بمعلوماتك الفعلية
   const CONTACTS_SHEET_ID = 'ضع_هنا_ID_ملف_الرسائل';
   const ORDERS_SHEET_ID = 'ضع_هنا_ID_ملف_الطلبات';
   ```

4. **تحديث البريد الإلكتروني (اختياري):**
   ```javascript
   const recipientEmail = 'your-email@example.com'; // بريدك الإلكتروني
   ```

### الخطوة 3: نشر التطبيق

1. **النشر كـ Web App:**
   - انقر على "نشر" → "نشر كتطبيق ويب جديد"
   - اختر الإعدادات التالية:
     - **Execute as:** Me
     - **Who has access:** Anyone
   - انقر على "Deploy"

2. **نسخ رابط Web App:**
   - انسخ الرابط الذي يظهر (يبدأ بـ `https://script.google.com/macros/s/...`)

### الخطوة 4: تحديث موقع الويب

افتح ملف `js/script.js` وحدث الرابط:

```javascript
// استبدل YOUR_SCRIPT_ID برابط Web App الخاص بك
const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec';
```

## اختبار النظام

### اختبار يدوي:
1. افتح موقع الويب
2. املأ نموذج التواصل واضغط إرسال
3. اضغط على "طلب سريع" لأحد المنتجات
4. تحقق من ملفات Google Sheets

### اختبار تلقائي:
في Google Apps Script، قم بتشغيل دالة `createSampleData()` لإنشاء بيانات تجريبية.

## ميزات النظام

### 🔄 المزامنة التلقائية
- يحفظ البيانات في Google Sheets فوراً
- في حالة الفشل، يحفظ محلياً ويعيد المحاولة
- مزامنة تلقائية كل 5 دقائق

### 📧 الإشعارات
- إشعار بريد إلكتروني فوري عند وصول رسالة جديدة
- إشعار بريد إلكتروني عند وصول طلب جديد
- تصميم HTML جميل للإشعارات

### 💾 النسخ الاحتياطي
- حفظ محلي في المتصفح كنسخة احتياطية
- استرداد تلقائي عند عودة الاتصال
- عدم فقدان أي بيانات

### 📊 التتبع المتقدم
- معرف فريد لكل رسالة/طلب
- تسجيل عنوان IP
- تسجيل نوع المتصفح
- طابع زمني دقيق

## إدارة البيانات

### عرض الإحصائيات:
في Google Apps Script، شغل دالة `getStatistics()` لعرض:
- عدد الرسائل الإجمالي
- عدد الطلبات الإجمالي
- آخر تحديث

### تصدير البيانات:
يمكنك تصدير البيانات من Google Sheets بتنسيقات مختلفة:
- Excel (.xlsx)
- CSV
- PDF

## حل المشاكل الشائعة

### المشكلة: لا يتم حفظ البيانات
**الحل:**
1. تأكد من صحة رابط Web App
2. تحقق من صحة IDs الملفات
3. تأكد من أذونات النشر

### المشكلة: لا تصل الإشعارات
**الحل:**
1. تحقق من صحة البريد الإلكتروني
2. تحقق من مجلد الرسائل غير المرغوب فيها

### المشكلة: خطأ في الأذونات
**الحل:**
1. تأكد من نشر التطبيق بأذونات "Anyone"
2. أعد نشر التطبيق إذا لزم الأمر

## الدعم والصيانة

### مراقبة دورية:
- تحقق من سجلات Google Apps Script للأخطاء
- راجع ملفات Google Sheets للتأكد من وصول البيانات
- اختبر النظام شهرياً

### النسخ الاحتياطي:
- قم بتصدير بيانات Google Sheets شهرياً
- احتفظ بنسخة من كود Google Apps Script

---

## الخلاصة

✅ **المميزات:**
- حفظ تلقائي لجميع الطلبات
- عدم فقدان أي بيانات
- إشعارات فورية
- سهولة الإدارة والتصدير

⚠️ **متطلبات الإعداد:**
- إعداد Google Apps Script مرة واحدة
- تحديث رابط Web App في الموقع
- تكوين إعدادات البريد الإلكتروني

🎯 **النتيجة:**
قاعدة بيانات احترافية ومجانية لإدارة طلبات العملاء!